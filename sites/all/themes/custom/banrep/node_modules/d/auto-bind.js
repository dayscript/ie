<<<<<<< HEAD
'use strict';

var copy             = require('es5-ext/object/copy')
  , normalizeOptions = require('es5-ext/object/normalize-options')
  , ensureCallable   = require('es5-ext/object/valid-callable')
  , map              = require('es5-ext/object/map')
  , callable         = require('es5-ext/object/valid-callable')
  , validValue       = require('es5-ext/object/valid-value')

  , bind = Function.prototype.bind, defineProperty = Object.defineProperty
=======
"use strict";

var isValue             = require("type/value/is")
  , ensureValue         = require("type/value/ensure")
  , ensurePlainFunction = require("type/plain-function/ensure")
  , copy                = require("es5-ext/object/copy")
  , normalizeOptions    = require("es5-ext/object/normalize-options")
  , map                 = require("es5-ext/object/map");

var bind = Function.prototype.bind
  , defineProperty = Object.defineProperty
>>>>>>> be4427ec9de1b66f0b9db9482bab10352696cef7
  , hasOwnProperty = Object.prototype.hasOwnProperty
  , define;

define = function (name, desc, options) {
<<<<<<< HEAD
	var value = validValue(desc) && callable(desc.value), dgs;
=======
	var value = ensureValue(desc) && ensurePlainFunction(desc.value), dgs;
>>>>>>> be4427ec9de1b66f0b9db9482bab10352696cef7
	dgs = copy(desc);
	delete dgs.writable;
	delete dgs.value;
	dgs.get = function () {
		if (!options.overwriteDefinition && hasOwnProperty.call(this, name)) return value;
		desc.value = bind.call(value, options.resolveContext ? options.resolveContext(this) : this);
		defineProperty(this, name, desc);
		return this[name];
	};
	return dgs;
};

module.exports = function (props/*, options*/) {
	var options = normalizeOptions(arguments[1]);
<<<<<<< HEAD
	if (options.resolveContext != null) ensureCallable(options.resolveContext);
=======
	if (isValue(options.resolveContext)) ensurePlainFunction(options.resolveContext);
>>>>>>> be4427ec9de1b66f0b9db9482bab10352696cef7
	return map(props, function (desc, name) { return define(name, desc, options); });
};
